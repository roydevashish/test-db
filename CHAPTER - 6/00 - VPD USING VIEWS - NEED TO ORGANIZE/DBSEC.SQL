CREATE TABLE EMPLOYEES_VER1 (
    EMPLOYEE_ID NUMBER(6) NOT NULL,
    FIRST_NAME VARCHAR2(20),
    LAST_NAME VARCHAR2(20) NOT NULL,
    EMAIL VARCHAR2(25) NOT NULL,
    PHONE_NUMBER VARCHAR2(20),
    HIRE_DATE DATE NOT NULL,
    JOB_ID VARCHAR2(10) NOT NULL,
    SALARY NUMBER(8,2),
    MANAGER_ID NUMBER(6),
    DEPARTMENT_ID NUMBER(4),
    CTL_UPD_USER VARCHAR2(30)
)
/

CREATE VIEW EMPLOYEES_VIEW1 AS 
    SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, MANAGER_ID, DEPARTMENT_ID, CTL_UPD_USER USER_NAME
    FROM EMPLOYEES_VER1
    WHERE CTL_UPD_USER = USER
/

GRANT SELECT, INSERT ON EMPLOYEES_VIEW1 TO SCOTT
/

INSERT INTO EMPLOYEES_VIEW1(EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, MANAGER_ID, DEPARTMENT_ID, USER_NAME)
VALUES(100, 'SAM', 'AFYOUNI', 'SAFYOUNI', '123-234-3456', SYSDATE, 'WM_CLK', 1000, 1000, 10, USER);

COMMIT
/

SELECT * FROM EMPLOYEES_VIEW1;

CREATE OR REPLACE TRIGGER TRG_EMPLOYEES_VER1_BEFORE_INS
    BEFORE INSERT
    ON EMPLOYEES_VER1
    FOR EACH ROW
BEGIN
    :NEW.CTL_UPD_USER := USER;
END;
/